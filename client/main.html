<!--
	Templates used in reading, creating, and editing
-->

<template name="story_header">
	{{setTitle title}}
	<div class="title-overlay {{#unless read}}write{{/unless}}">
		<div id="banner-overlay">						
		</div>
		<div class="title-author">
			<div class="title" contenteditable="true">{{title}}</div>
			<div class="author" contenteditable="true">By {{username}}</div>
		</div>
		<div class="logo">
			<a href="/">
				<img src="/logo.png">
			</a>
		</div>
	</div>
</template>

<template name="story">
	<!-- Mesh Background Overlay -->
	<!-- <div id="overlay"></div> -->
	<article class="content">
		<div class="vertical-narrative {{#if narrativeView}}narrativeView{{/if}}" style="width: {{cardWidth}}px; left: {{verticalLeft}}px;">
			{{> vertical_narrative}}
			<div class="spacer">
			</div>
		</div>
		{{#unless narrativeView}}
		<div class="horizontal-context">
			{{> horizontal_context}}
		</div>
		{{/unless}}
	</article>

	{{#if pastHeader}}
	    {{#if horizontalExists}}
	    <div class="browser-offset">
	    	{{> story_browser}}
	    </div>
	    {{/if}}
	{{/if}}
</template>

<template name="vertical_section_block">
	<section class="narrative-section vertical-narrative-section{{#if verticalSelected}} selected{{/if}} {{#if read}}read{{/if}}" data-vertical-index="{{index}}">
		<div class="title {{#unless read}}editable{{/unless}}" contenteditable="{{#unless read}}true{{/unless}}">{{title}}</div>
		<div class="content {{#unless read}}editable{{/unless}}" contenteditable="{{#unless read}}true{{/unless}}">
			<p contenteditable="true">{{content}}</p>
			<img src="{{image}}" />
		</div>
	</section>
</template>

<template name="vertical_narrative">
	{{#each verticalSections}}
    	{{> vertical_section_block}}
    	{{#unless read}}
        	{{> minimized_add_vertical}}
    	{{/unless}}
	{{/each}}	
	{{#unless read}}
    	{{! > add_vertical}}
	{{/unless}}
</template>

<template name="horizontal_context">
	{{#unless read}}
    	{{#if verticalExists}}
        	{{! > add_horizontal}}
        {{/if}}
    {{/unless}}
	{{#each horizontalSections}}
	    {{#if horizontalShown}}
        {{#each data}}
            {{#unless read}}
                {{! > minimized_add_horizontal}}
        	{{/unless}}
            {{#if read}}
   	            {{#if type}}
       	            {{> horizontal_section_block}}
   	            {{/if}}
   	        {{else}}
       	        {{> horizontal_section_block}}
   	        {{/if}}
   	    {{/each}}
   	    {{#unless read}}
        	{{! > minimized_add_horizontal}}
    	{{/unless}}
   	    {{/if}}
	{{/each}}
</template>

<template name="horizontal_section_block">
	<section class="narrative-section horizontal-narrative-section {{#if first}}first{{/if}}" data-index={{index}} style="width: {{cardWidth}}px; left: {{left}}px">
		{{#if type}}
		    {{#if text}}{{> display_text_section}}{{/if}}
		    {{#if image}}{{> display_image_section}}{{/if}}
		    {{#if map}}{{> display_map_section}}{{/if}}
		{{else}}
    		{{> horizontal_section_buttons}}
    	{{/if}}
	</section>
</template>

<!-- Display Templates -->
<template name="display_text_section">
	<div class="text-section">
    	{{content}}
    </div>
    {{#unless read}}
    	{{> horizontal_section_edit_delete}}
    {{/unless}}
</template>

<template name="display_image_section">
	<div class="image-section">
		<img src="{{url}}" />
		{{#if description}}
    		<div class="description-overlay">
    			{{description}}
    		</div>
    	{{/if}}
	</div>
	{{#unless read}}
    	{{> horizontal_section_edit_delete}}
    {{/unless}}
</template>

<template name="story_browser">
	<div class="story-browser">
		<i class="fa fa-chevron-left fa-2x left"></i>
		<i class="fa fa-chevron-right fa-2x right"></i>
	</div>
</template>