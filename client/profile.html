<template name="profile">
  {{> top_banner border="remix-border"}}
    <section>
      <div class="user_profile">
        {{> user_profile}}
      </div>
    </section>
    <div class="stories">
      <section>
        <div class="story-container">
          {{> user_stories}}
        </div>
        <div class="horizontal-line"></div>
        <div class="story-container">
          {{> user_favorite_stories}}
        </div>
      </section>
    </div>
  {{> footer}}
</template>


<template name="user_profile">
  {{#if ownProfile}}
    <button class="edit_profile">Edit</button>
  {{/if}}
  {{#if editting}}
    {{#autoForm collection=UsersCollection doc=currentUser id="updateProfileForm" type="update" validation="keyup"}}
      {{> afQuickField name='profile.name'}}
      {{> afQuickField name='profile.bio'}}
      <!-- {{> afQuickField name='emails.0.address'}} -->
      <button type="submit" class="save-profile-button">Save</button>
    {{/autoForm}}
  {{else}}
    <div class="profile-picture">
      {{#if profileImage}} 
         <img class="profile-picture-large" src="{{profileImage}}"/>
      {{/if}}
    </div>
    <div class="username">{{username}}</div>
    <div class="bio">{{bio}}</div>
  {{/if}}
</template>

<template name="user_stories">
  <h1>Latest stories</h1>
  {{#each writtenStories}}
    {{#linkTo route="read" data=this}}
      <div class="story" data-story-id="{{_id}}">
        {{> _story_preview_content}}
      </div>
    {{/linkTo}}
  {{/each}}
</template>

<template name="user_favorite_stories">
  <h1>Favorites</h1>
  {{#each favoriteStories}}
    {{> story_preview }}
  {{/each}}
</template>


<template name="my_story_profile">
  {{> top_banner border="remix-border"}}
  <div class="stories">
    <section>
      <div class="story-container">
        {{> my_stories}}
      </div>
    </section>
  </div>
</template>

<template name="my_stories">
  <h1>My Drafts</h1>
  {{#each writtenStories}}
    {{#linkTo route="edit" data=this}}
      <div class="story" data-story-id="{{_id}}">
        {{#with draftStory}}
          {{> _story_preview_content}}
        {{/with}}
        <!--<div class="dates">-->
          <!--<p>Last Edited: {{lastEditDate}}</p>-->
          <!--<p>-->
            <!--{{#if published}}-->
              <!--Published On: {{lastPublishDate}}-->
              <!--{{else}}-->
              <!--Unpublished-->
            <!--{{/if}}-->
          <!--</p>-->
        <!--</div>-->
      </div>
    {{/linkTo}}
  {{/each}}
</template>
