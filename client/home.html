<head>
  <title>FOLD</title>
  <link rel="apple-touch-icon" href="/FOLD-apple-touch-icon.png">
  <link rel="shortcut icon" href="/favicon.ico" />
</head>

<template name="top_banner">
  <div class="home-top">
    <div class="left">
      <div class="logo-title">
        {{#linkTo route="home"}}
        <img src="/FOLD_LOGO.svg">
        {{/linkTo}}
        {{#linkTo route="home"}}
        <div class="title">
          <img src="/FOLD_TITLE.svg">
        </div>
        {{/linkTo}}
      </div>
      <div class="filter">
        {{> filters}} in {{> categories}}
      </div>
    </div>
    <div class="right">
      <div class="action-items">
        <ol>
          <li class="create-story">
            {{> create_story}}
          </li>
          <li class="user-action">
            {{> login_buttons }}
          </li>
          <li class="about-fold">
            {{#linkTo route="about"}}
                About FOLD
            {{/linkTo}}
          </li>
        </ol>
      </div>
      <div class="user-image">
        <div class="author-image">
          {{#if profileImage}}
          <img class="profile-picture" src="{{profileImage}}"/>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</template>

<template name="login_buttons">
    {{#if currentUser}}
      <button class="logout"> Log out</button>
    {{else}}
      <button class="signin"> Log in / Sign up</button>
      {{#if signingIn}}
      <ol class="signin">
        <li>
          <button class="twitter-signin">Log in with Twitter</button>
        </li>
        <li>
          <button class="email-signin">Log in with email</button>
        </li>
      </ol>
      {{/if}}
    {{/if}}
</template>

<template name="create_story">
  <a class="create-story" href="javascript:void(0);">
    Make a Story
  </a>
</template>

<template name="home">
  {{> top_banner}}
  <div class="stories"> 
    <section>
      <div class="story-container">
        {{> all_stories}}
      </div>
    </section>
  </div>
</template>

<template name="filters">
  <span class="filters">
    <select data-custom-id="custom" data-custom-class="custom">
      {{#each filters}}
        <option value="{{this}}">
          {{this}}
        </option>
      {{/each}}
    </select>
  </span>
</template>

<template name="categories">
  <span class="categories">
    <select>
      {{#each categories}}
        <option class="category {{#if selected}}selected{{/if}}" data-category="{{this}}">
          {{this}}
        </option>
      {{/each}}
    </select>
  </span>
</template>

<template name="all_stories">
  {{#each stories}}
    {{> story_preview}}
  {{/each}}
</template>

<template name="story_preview">
  <div class="story" data-story-id="{{_id}}">
    {{#if isAuthor}}
      {{#linkTo route="edit" data=this}}
        {{> _story_preview_content}}
        {{> edit_or_read_bar}}
      {{/linkTo}}
    {{else}}
      {{#linkTo route="read" data=this}}
        {{> _story_preview_content}}
        {{> edit_or_read_bar}}
      {{/linkTo}}
    {{/if}}
  </div>
</template>

<template name="_story_preview_content">
  <div class="content-count">
    <!--{{ > twitter_icon }}-->
    {{#if contextCountOfType 'video'}}
      {{ > video_icon }}
      <!--{{contextCountOfType 'video'}}-->
    {{/if}}
    {{#if contextCountOfType 'map'}}
      {{ > map_icon }}
      <!--{{contextCountOfType 'map'}}-->
    {{/if}}
    <!--{{ > image_icon }}-->
    {{#if contextCountOfType 'viz'}}
      {{ > viz_icon }}
      <!--{{contextCountOfType 'viz'}}-->
    {{/if}}
    <!--{{ > gif_icon }}-->
    <!--{{ > audio_icon }}-->
    {{#if contextCountOfType 'text'}}
      {{ > text_icon }}
      <!--{{contextCountOfType 'text'}}-->
    {{/if}}
    <!--TODO - add remix check-->
  </div>
  <div class="overlay-image">
    <img src="{{backgroundImage}}" />
  </div>
  <div class="headline">
    {{title}}
  </div>

  <div class="byline">
    <div class="pull-left">
      <div class="author-image">
        {{#if profileImage}} 
         <img class="profile-picture" src="{{profileImage}}"/>
        {{/if}}
      </div>

      <div class="author-name-date">
        <div class="author-name">By {{authorName}}</div>
        <div class="publish-date">{{lastPublishDate}}</div>
      </div>
    </div>
    <!--<div class="pull-right">-->
      <!--{{ > favorite_button }}-->
    <!--</div>-->
  </div>
</template>

<template name="edit_or_read_bar">
  <div class="edit-or-read">

  </div>
</template>
