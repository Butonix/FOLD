

<template name="top_banner">
  <div class="home-top {{#if border}}{{border}}{{/if}}">
    <div class="left">
      <div class="logo-title">
        {{#linkTo route="home"}}
        <img class="logo" src="/FOLD_LOGO.svg">
        {{/linkTo}}
        {{#linkTo route="home"}}
        <div class="title">
          <img src="/FOLD_TITLE.svg">
        </div>
        {{/linkTo}}
      </div>
      {{#if showFilters}}
      <div class="filter">
        {{> filters}}
        <!--{{> filters}} in {{> categories}}-->
      </div>
      {{/if}}
    </div>
    {{> banner_buttons}}
    {{> signin_overlay}}
  </div>
</template>

<template name="signin_overlay">
  {{#if signingIn}}
    <div class="signin-overlay" style="width: {{windowWidth}}px; height: {{windowHeight}}px;">
      <button class="close">âœ•</button>
      <div class="signin-buttons">
        <ol class="user-menu">
          <li>
            <button class="twitter-signin">Log in with Twitter</button>
          </li>
          <li>
            <button class="email-signin">Log in with email</button>
          </li>
        </ol>
      </div>
    </div>
  {{/if}}
</template>

<template name="top_banner_simple_no_links">
  <div class="home-top remix-color">
    <div class="left">
      <div class="logo-title">
          <img class="logo" src="/FOLD_LOGO.svg">
          <div class="title">
            <img src="/FOLD_TITLE.svg">
          </div>
      </div>
    </div>
  </div>
</template>

<template name="top_banner_simple">
  <div class="home-top remix-color">
    <div class="left">
      <div class="logo-title">
          {{#linkTo route="home"}}
          <img class="logo" src="/FOLD_LOGO.svg">
          {{/linkTo}}
          {{#linkTo route="home"}}
          <div class="title">
            <img src="/FOLD_TITLE.svg">
          </div>
          {{/linkTo}}
      </div>
    </div>
  </div>
</template>

<template name="banner_buttons">
  <div class="right">
    <div class="action-items">
      <ol>
        {{#unless isPhone}}
          {{#if showCreateStory}}
            <li class="create-story">
              {{> create_story}}
            </li>
          {{/if}}
        {{/unless}}
        <li class="user-action">
          {{> login_buttons }}
        </li>

        {{#unless isPhone}}
          <li class="about-fold">
            <button>
              {{#linkTo route="about"}}
                About FOLD
              {{/linkTo}}
            </button>
          </li>
        {{/unless}}
      </ol>
    </div>
    <div class="user-image">
      <div class="author-image">
        <!-- TODO, CHANGE AUTHORPIC -->
        {{#if profileImage}}
          <img class="profile-picture" src="{{profileImage}}"/>
        {{/if}} 
      </div>
    </div>
  </div>
</template>
<template name="login_buttons">
    {{#if currentUser}}
      {{#linkTo route="profile" data=currentUser}}
        <button>{{currentUser.profile.name}}</button>
      {{/linkTo}}
      {{#if showUserInfo}}
        <ol class="user-menu">
          <li>
            {{#linkTo route="my_story_profile"}}<button>My stories</button>{{/linkTo}}
          </li>
          <li>
            <button class="logout">Logout</button>
          </li>
        </ol>
      {{/if}}
    {{else}}
      <button class="signin"> Log in / Sign up</button>
    {{/if}}
</template>

<template name="create_story">
  <button class="create-story" href="javascript:void(0);">
    Make a Story
  </button>
</template>

<template name="home">
  {{> top_banner  showFilters="true" border="active-border"}}
  <div class="stories"> 
    <section>
      <div class="story-container">
        {{> all_stories}}
      </div>
    </section>
  </div>
</template>

<template name="filters">
  <span class="filters">
    <select data-custom-id="custom" data-custom-class="custom">
      {{#each filters}}
        <option value="{{this}}">
          {{this}}
        </option>
      {{/each}}
    </select>
  </span>
</template>

<template name="categories">
  <span class="categories">
    <select>
      {{#each categories}}
        <option class="category {{#if selected}}selected{{/if}}" data-category="{{this}}">
          {{this}}
        </option>
      {{/each}}
    </select>
  </span>
</template>

<template name="all_stories">
  {{#each stories}}
      {{> story_preview}}
  {{else}}
    <h2 style="text-align: center">FOLD will launch on April 22nd.</h2>
    <h3 style="text-align: center">If you have a secret code, please sign up above.</h3>
  {{/each}}
</template>

<template name="story_preview">
  {{#with story}}
    <div class="story" data-story-id="{{_id}}">
      {{> _story_preview_content}}
      {{> edit_or_read_bar}}
    </div>
  {{/with}}
</template>

<template name="_story_preview_content">
  {{#with story}}
    <div class="content-count">
      {{#if contextCountOfType 'video'}}
        {{ > video_icon }}
        <!--{{contextCountOfType 'video'}}-->
      {{/if}}
      {{#if contextCountOfType 'image'}}
        {{ > image_icon }}
        <!--{{contextCountOfType 'image'}}-->
      {{/if}}
      {{#if contextCountOfType 'gif'}}
        {{ > gif_icon }}
        <!--{{contextCountOfType 'gif'}}-->
      {{/if}}
      {{#if contextCountOfType 'map'}}
        {{ > map_icon }}
        <!--{{contextCountOfType 'map'}}-->
      {{/if}}
      {{#if contextCountOfType 'twitter'}}
        {{ > twitter_icon }}
        <!--{{contextCountOfType 'twitter'}}-->
      {{/if}}
      {{#if contextCountOfType 'audio'}}
        {{ > audio_icon }}
        <!--{{contextCountOfType 'audio'}}-->
      {{/if}}
      {{#if contextCountOfType 'viz'}}
        {{ > viz_icon }}
        <!--{{contextCountOfType 'viz'}}-->
      {{/if}}
      {{#if contextCountOfType 'text'}}
        {{ > text_icon }}
        <!--{{contextCountOfType 'text'}}-->
      {{/if}}
      {{#if contextCountOfType 'link'}}
        {{ > link_icon }}
        <!--{{contextCountOfType 'link'}}-->
      {{/if}}
      <!--TODO - add remix check-->
    </div>

    {{#linkTo route=linkRoute data=this}}
      <div class="overlay-image">
        <img src="{{headerImageUrl}}" />
      </div>
    {{/linkTo}}

    {{#linkTo route=linkRoute data=this}}
      <div class="story-card">
      </div>
    {{/linkTo}}

    {{#linkTo route=linkRoute data=this}}
      <div class="headline">
        {{title}}
      </div>
    {{/linkTo}}

    <div class="byline">
      <a class="author-profile-link" href="{{profileUrl}}" >
        <div class="pull-left">
          <div class="author-image">
            {{#if profileImage author}}
             <img class="profile-picture" src="{{profileImage author}}"/>
            {{else}}
              <div class="author-image-placeholder"></div>
            {{/if}}
          </div>

          <div class="author-name-date">
            <div class="author-name">By <span>{{authorName}}</span></div>
            <div class="publish-date">{{lastPublishDate}}</div>
          </div>
        </div>
      </a>

      <div class="pull-right">
        {{ > favorite_button }}
      </div>
    </div>
  {{/with}}

</template>

<template name="edit_or_read_bar">
  <div class="edit-or-read">

  </div>
</template>
