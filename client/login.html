<template name="signin_overlay">
  {{#if signingIn}}
    <div class="signin-overlay" style="width: {{windowWidth}}px; height: {{windowHeight}}px;">

      <div class="signin-modal">
        <button class="close">✕</button>
        <div class="title"><img src="{{c.url 'static/foldtitle.svg'}}"></div>

        {{#if onSignupStage}}
          <div class="slogan">Create. Remix. Discover.</div>
          {{#if explanation}}
            <div class="explanation">{{explanation}}</div>
          {{/if}}
          <ol class="user-menu">
            <li>
              <button class="twitter-signin">Sign in with Twitter</button>
            </li>
            <li>
              <button class="email-signup">Sign up with email</button>
            </li>
          </ol>
          <div class="already-have">Already have an account? <button class="go-to-login">Sign in.</button></div>
        {{/if}}

        {{#if onLoginStage}}
          {{> login_form}}
        {{/if}}

        {{#if onInfoStage}}
          {{> info_form}}
        {{/if}}

        {{#if onPasswordStage}}
          {{> password_form}}
        {{/if}}

        {{#if onOnboardingStage}}
          {{> onboarding_screen}}
        {{/if}}

      </div>

    </div>
  {{/if}}
</template>

<template name="info_form">
  {{#unless twitterUser}}
    <button class="back-to-signup">{{> back_arrow}}</button>
  {{/unless}}
  <form id="info-form" action="action">
    <!-- Email -->
    <label for="email"> What's your e-mail? </label>
    {{#if emailError}}<span class="error">{{emailError}}</span>{{/if}}
    <input id="signup-email"
           name="email"
           type="email"
           placeholder="author@example.com"
           dir="auto"
           autofocus="autofocus"
           class="{{#if emailError}}error{{/if}}"
           required
        >

    <!-- Name -->
    <label for="name"> What's your name? This will be your byline on stories. </label>
    {{#if nameError}}<span class="error">{{nameError}}</span>{{/if}}
    <input id="signup-name"
           name="name"
           type="text"
           placeholder="First Last"
           dir="auto"
           value="{{#if currentUser.profile.name}}{{currentUser.profile.name}}{{/if}}"
           class="{{#if nameError}}error{{/if}}"
           required
        >

    <!-- Username -->
    <label for="username">What's your username?</label>
    {{#if usernameError}}<span class="error">{{usernameError}}</span>{{/if}}
    <input id="signup-username"
           name="username"
           type="text"
           placeholder="Username"
           dir="auto"
           value="{{#if currentUser.tempUsername}}{{currentUser.tempUsername}}{{/if}}"
           class="{{#if usernameError}}error{{/if}}"
           required
        >

    {{#if signupError}}<div class="error">{{signupError}}</div>{{/if}}


    {{#if twitterUser}}
      <p>By creating an account, I accept FOLD’s {{#linkTo route="terms" target='_blank' class='green'}}Terms of Service{{/linkTo}} and {{#linkTo route="privacy" target='_blank' class='green'}}Privacy Policy{{/linkTo}}.</p>
      <button type="submit" class="signup-button">Sign up</button>
    {{else}}
      <button type="submit" class="signup-button">Next</button>
    {{/if}}

    {{#if disableSignup}}
      {{>loading_icon}}
    {{/if}}
  </form>
</template>


<template name="password_form">
  <form id="password-form" action="action">
    <!-- Password -->
    <label for="password">Choose a password</label>
    {{#if passwordError}}<span class="error">{{passwordError}}</span>{{/if}}
    <input id="signup-password"
           name="password"
           type="password"
           placeholder="password"
           dir="auto"
           class="{{#if passwordError}}error{{/if}}"
           required
        >
    <label for="password2">Reenter your password</label>
    {{#if password2Error}}<span class="error">{{password2Error}}</span>{{/if}}
    <input id="signup-password2"
           name="password2"
           type="password"
           placeholder="password"
           dir="auto"
           class="{{#if password2Error}}error{{/if}}"
           required
        >

    {{#if signupError}}<div class="error">{{signupError}}</div>{{/if}}

    <p>By creating an account, I accept FOLD’s {{#linkTo route="terms" target='_blank' class='green'}}Terms of Service{{/linkTo}} and {{#linkTo route="privacy" target='_blank' class='green'}}Privacy Policy{{/linkTo}}.</p>
    <button type="submit" class="signup-button">Sign up</button>
    {{#if disableSignup}}
      {{>loading_icon}}
    {{/if}}
  </form>
</template>


<template name="onboarding_screen">
  {{#with currentUser}}
    <div class="all-set">You're all set!</div>
    <div class="author-image">
      <img class="profile-picture" src="{{profileImage this}}"/>
    </div>

    <div class="author-name-username">
      <div class="author-name">{{profile.name}}</div>
      <div class="publish-date">{{username}}</div>
    </div>
    <div>
      To edit your photo or display name, visit your <a href="/profile/{{username}}" class="green">profile</a>.
    </div>
    <button class="finish">Thanks</button>
  {{/with}}
</template>



<template name="login">
  {{> top_banner_simple_no_links}}
  <div class="login">
    <section>
      {{> login_form}}
    </section>
  </div>
</template>

<template name="login_form">
  <button class="back-to-signup">{{> back_arrow}}</button>
  <form id="login-form" action="action">
    <label for="username"> Username or Email </label>
    <input name="username" type="text" placeholder="username or email" autofocus="autofocus" required>
    <label for="password"> Password </label>
    <input name="password" type="password" placeholder="password" required>

    {{#if loginError}}
      <div class="error">
        {{loginError}}
      </div>
    {{/if}}

    <button type="submit" class="login-button">Log in</button>
    {{#if loggingIn}}
      {{> loading_icon}}
    {{/if}}
    <a href="/recover-password" class="recover-password-link">Lost password?</a>
  </form>
  <div class="vertical-divider">OR</div>
  <button class="twitter-signin">Sign in with Twitter</button>
</template>
